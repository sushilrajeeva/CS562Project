//Find for customer Knuth, the average sale in “NY”, the average sale in “CT” and the average sale in “NJ”, if New York's average is greater than the other two. 


CREATE VIEW NY AS
	SELECT CUST, SUM(QUANT)/COUNT(QUANT) AS NY_AVG
	FROM SALES
	WHERE STATE = 'NY'
	GROUP BY CUST
	
SELECT * FROM NY

CREATE VIEW NJ AS
	SELECT CUST, SUM(QUANT)/COUNT(QUANT) AS NJ_AVG
	FROM SALES
	WHERE STATE='NJ'
	GROUP BY CUST
	
SELECT * FROM NJ

CREATE VIEW CT AS
	SELECT CUST, SUM(QUANT)/COUNT(QUANT) AS CT_AVG
	FROM SALES
	WHERE STATE='CT'
	GROUP BY CUST
	
SELECT * FROM CT

SELECT NY.CUST, NY.NY_AVG, NJ.NJ_AVG, CT.CT_AVG
FROM NY,NJ,CT
WHERE NY.CUST=NJ.CUST AND NY.CUST=CT.CUST
