//Find for each customer and product the sum sale in “PA”, the sum sale in “CT” and the sum sale in “NJ” and also the total number of months they made sales in for each respective states.

CREATE VIEW MFQ4_View1 AS
	SELECT CUST, PROD, SUM(QUANT) AS SUM, COUNT(MONTH) AS COUNT
	FROM SALES
	WHERE STATE='PA'
	GROUP BY CUST, PROD
	
SELECT * FROM MFQ4_View1

CREATE VIEW MFQ4_View2 AS
	SELECT CUST, PROD, SUM(QUANT) AS SUM, COUNT(MONTH) AS COUNT
	FROM SALES
	WHERE STATE='NJ'
	GROUP BY CUST, PROD
	
SELECT * FROM MFQ4_View2

CREATE VIEW MFQ4_View3 AS
	SELECT CUST, PROD, SUM(QUANT) AS SUM, COUNT(MONTH) AS COUNT
	FROM SALES
	WHERE STATE='CT'
	GROUP BY CUST, PROD
	
SELECT * FROM MFQ4_View3

SELECT V1.CUST, V1.PROD, V1.SUM AS SUM1, V2.SUM AS SUM2, V3.SUM AS SUM3, V1.COUNT AS COUNT1, V2.COUNT AS COUNT2, V3.COUNT AS COUNT3
FROM MFQ4_View1 AS V1, MFQ4_View2 AS V2, MFQ4_View3 AS V3
WHERE V1.CUST=V2.CUST AND V1.CUST = V3.CUST AND V1.PROD = V2.PROD AND V1.PROD = V3.PROD
